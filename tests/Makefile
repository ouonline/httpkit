# This Makefile is generated by omake: https://github.com/ouonline/omake.git

AR := ar
CC := gcc

ifeq ($(debug), y)
	CFLAGS := -g
else
	CFLAGS := -O2 -DNDEBUG
endif
CFLAGS := $(CFLAGS) -Wall -Werror -Wextra -fPIC

TARGET := test_httpkit

.PHONY: all clean

all: $(TARGET)

test_httpkit_OBJS := ./test.c.test_httpkit.o

test_httpkit_INCLUDE := -I../..

test_httpkit_LIBS := ../libhttpkit.a ../../utils/libutils.a

./test.c.test_httpkit.o: ./test.c
	$(CC) $(CFLAGS) $(test_httpkit_INCLUDE) -c $< -o $@

.PHONY: test_httpkit_pre_process

$(test_httpkit_OBJS): | test_httpkit_pre_process

test_httpkit_pre_process:
	$(MAKE) debug=$(debug) -C ..
	$(MAKE) debug=$(debug) -C ../../utils

test_httpkit: $(test_httpkit_OBJS)
	$(CC) $(CFLAGS) -o $@ $^ $(test_httpkit_LIBS)

clean:
	rm -f $(TARGET) $(test_httpkit_OBJS)
